<div class="auth-page">
  <div class="auth-container">
    <div class="logo">
      <span class="logo-icon">tr</span>
      <span class="logo-train">â–²</span>
      <span class="logo-text">inTrack</span>
    </div>

    <div class="auth-card">
      <h1>Reset Password</h1>
      
      <div class="info-box">
        <p>Enter the reset code sent to</p>
        <p class="email-highlight">{{ email }}</p>
      </div>

      <form [formGroup]="resetPasswordForm" (ngSubmit)="onSubmit()">
        <div class="input-group code-input-group">
          <input
            #codeInput
            type="text"
            inputmode="numeric"
            formControlName="resetCode"
            placeholder="Enter 6-digit code"
            [class.error-input]="submitted && f['resetCode'].errors"
            autocomplete="one-time-code"
            maxlength="6"
            (input)="onCodeInput($event)"
          />
        </div>

        <div *ngIf="submitted && f['resetCode'].errors" class="error-message">
          <span *ngIf="f['resetCode'].errors['required']">Reset code is required</span>
          <span *ngIf="f['resetCode'].errors['pattern'] || f['resetCode'].errors['minlength']">
            Please enter a valid 6-digit code
          </span>
        </div>

        <div class="input-group">
          <input
            type="password"
            formControlName="newPassword"
            placeholder="New Password"
            [class.error-input]="submitted && f['newPassword'].errors"
            autocomplete="new-password"
          />
        </div>
        <div *ngIf="submitted && f['newPassword'].errors" class="error-message">
          <span *ngIf="f['newPassword'].errors['required']">Password is required</span>
          <span *ngIf="f['newPassword'].errors['minlength']">Password must be at least 8 characters</span>
        </div>

        <div class="input-group">
          <input
            type="password"
            formControlName="confirmPassword"
            placeholder="Confirm New Password"
            [class.error-input]="submitted && f['confirmPassword'].errors"
            autocomplete="new-password"
          />
        </div>
        <div *ngIf="submitted && f['confirmPassword'].errors" class="error-message">
          <span *ngIf="f['confirmPassword'].errors['required']">Please confirm your password</span>
          <span *ngIf="f['confirmPassword'].errors['passwordMismatch']">Passwords do not match</span>
        </div>

        <div *ngIf="error" class="alert-error">
          {{ error }}
        </div>

        <div *ngIf="success" class="alert-success">
          {{ success }}
        </div>

        <button type="submit" class="btn-gradient" [disabled]="loading">
          {{ loading ? 'Resetting...' : 'Reset Password' }}
        </button>

        <div class="footer-text">
          Didn't receive the code? 
          <a class="link-primary" routerLink="/forgot-password">Request again</a>
        </div>

        <div class="footer-link">
          Remember your password? 
          <a routerLink="/login" class="link-primary">Login</a>
        </div>
      </form>
    </div>
  </div>
</div>